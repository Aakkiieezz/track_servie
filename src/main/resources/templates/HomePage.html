<!DOCTYPE html>
<html lang="en" xmlns:th="http://thymeleaf.org">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

  <!-- Bootstrap Font Icon CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" />

  <!-- CSS -->
  <link rel="stylesheet" href="/src/main/resources/static/css/mystyles.css" th:href="@{/css/mystyles.css}">

  <!-- Favicon -->
  <!-- <link rel="icon" href="path/to/favicon.ico" type="image/x-icon"> -->
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='white' class='bi bi-film' viewBox='0 0 16 16'%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3Cpath d='M0 1a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V1zm4 0v6h8V1H4zm8 8H4v6h8V9zM1 1v2h2V1H1zm2 3H1v2h2V4zM1 7v2h2V7H1zm2 3H1v2h2v-2zm-2 3v2h2v-2H1zM15 1h-2v2h2V1zm-2 3v2h2V4h-2zm2 3h-2v2h2V7zm-2 3v2h2v-2h-2zm2 3h-2v2h2v-2z'/%3E%3C/svg%3E">

  <!-- Include Bootstrap JavaScript with Popper.js and Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- jQuery (only required if Bootstrap's dropdown functionality needs it) -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha384-KyZXEAg3QhqLMpG8r+ctfLvpeMOG6AyqE+0jJWPTa8uqzdhxhxvgj3Y6z68i8+4M"
    crossorigin="anonymous"></script>

  <script>
    function toggleWatch(tmdbId, childtype, watched) {
      $.ajax({
        type: "POST",
        url: "/track-servie/servies/js_toggleback",
        data: JSON.stringify({ tmdbId: tmdbId, childtype: childtype, watched: watched }),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (data) {
          if (data.success) {
            var movieDiv = $('#' + childtype + tmdbId);
            if (watched) {
              movieDiv.find(".bi-eye-fill").removeClass("bi-eye-fill").addClass("bi-eye-slash-fill");
            } else {
              movieDiv.find(".bi-eye-slash-fill").removeClass("bi-eye-slash-fill").addClass("bi-eye-fill");
            }
          } else {
            alert("Failed to update watched status.");
          }
        },
        error: function () {
          alert("Failed to update watched status.");
        }
      });
    }

    function removeServie(tmdbId, childtype) {
      $.ajax({
        type: "POST",
        url: "/track-servie/servies/remove",
        data: JSON.stringify({ tmdbId: tmdbId, childtype: childtype }),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (data) {
          $('#' + childtype + tmdbId).remove();
        },
        error: function () {
          alert("Failed to remove servie");
        }
      });
    }

    // previously working before having checkboxes
    // $(document).ready(function () {
    //   var typeDropdown = $('#type');
    //   var genreDropdown = $('#genreIds');
    //   typeDropdown.on('change', function () {
    //     var selectedType = $(this).val();
    //     genreDropdown.find('option').prop('disabled', false);

    //     // Disable options in genre dropdown based on selected type
    //     if (selectedType === 'movie') {
    //       // Disable options with values [12, 15, 16, 17, 20, 21]
    //       genreDropdown.find('option[value="12"], option[value="15"], option[value="16"], option[value="17"], option[value="20"], option[value="21"]').prop('disabled', true);
    //     } else if (selectedType === 'tv') {
    //       // Disable options with values [10, 11, 13, 18, 22, 23]
    //       genreDropdown.find('option[value="10"], option[value="11"], option[value="13"], option[value="18"], option[value="22"], option[value="23"]').prop('disabled', true);
    //     }
    //   });
    // });

    $(document).ready(function () {
      var typeDropdown = $('#type');
      typeDropdown.on('change', function () {
        var selectedType = $(this).val();
        $('input[name="genreIds"]').each(function () {
          var checkboxValue = $(this).val();
          var shouldBeDisabled = shouldCheckboxBeDisabled(selectedType, checkboxValue);
          $(this).prop('disabled', shouldBeDisabled);
        });
      });
    });

    function shouldCheckboxBeDisabled(selectedType, checkboxValue) {
      if (selectedType === 'movie') {
        return checkboxValue === '12' || checkboxValue === '15' || checkboxValue === '16' || checkboxValue === '17' || checkboxValue === '20' || checkboxValue === '21';
      } else if (selectedType === 'tv') {
        return checkboxValue === '10' || checkboxValue === '11' || checkboxValue === '13' || checkboxValue === '18' || checkboxValue === '22' || checkboxValue === '23';
      }
      return false;
    }

  </script>

  <title>Home Page</title>
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <div class="col-9">
        <form th:action="@{/track-servie/servies}" th:object="${serviceForm}" method="post"
          class="d-flex flex-row align-items-center">

          <i class="bi bi-arrow-down-up"></i>
          <!-- <select name="type" id="type"> -->
          <select th:field="*{type}" id="type">
            <option value="">Servies</option>
            <option value="movie">Movies</option>
            <option value="tv">Series</option>
          </select>

          &nbsp;
          &nbsp;

          <i class="bi bi-filter-right"></i>
          <!-- <select name="sortBy"> -->
          <select th:field="*{sortBy}">
            <option value="title">Title</option>
            <option value="date">Release Date</option>
          </select>

          &nbsp;
          &nbsp;

          <i class="bi bi-arrow-down-up"></i>
          <!-- <select name="sortDir"> -->
          <select th:field="*{sortDir}">
            <option value="asc">Ascending</option>
            <option value="desc">Descending</option>
          </select>

          &nbsp;
          &nbsp;

          <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="genreDropdown" data-bs-toggle="dropdown"
              aria-expanded="false">
              Select Genres
            </button>
            <ul class="dropdown-menu" aria-labelledby="genreDropdown" id="genreCheckboxes">
              <li><input class="form-check-input" type="checkbox" id="genre1" name="genreIds" value="1">
                <label class="form-check-label" for="genre1">Action</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre2" name="genreIds" value="2">
                <label class="form-check-label" for="genre2">Adventure</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre3" name="genreIds" value="3">
                <label class="form-check-label" for="genre3">Animation</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre4" name="genreIds" value="4">
                <label class="form-check-label" for="genre4">Comedy</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre5" name="genreIds" value="5">
                <label class="form-check-label" for="genre5">Crime</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre6" name="genreIds" value="6">
                <label class="form-check-label" for="genre6">Documentary</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre7" name="genreIds" value="7">
                <label class="form-check-label" for="genre7">Drama</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre8" name="genreIds" value="8">
                <label class="form-check-label" for="genre8">Family</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre9" name="genreIds" value="9">
                <label class="form-check-label" for="genre9">Fantasy</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre10" name="genreIds" value="10">
                <label class="form-check-label" for="genre10">History</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre11" name="genreIds" value="11">
                <label class="form-check-label" for="genre11">Horror</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre12" name="genreIds" value="12">
                <label class="form-check-label" for="genre12">Kids</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre13" name="genreIds" value="13">
                <label class="form-check-label" for="genre13">Music</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre14" name="genreIds" value="14">
                <label class="form-check-label" for="genre14">Mystery</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre15" name="genreIds" value="15">
                <label class="form-check-label" for="genre15">News</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre16" name="genreIds" value="16">
                <label class="form-check-label" for="genre16">Politics</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre17" name="genreIds" value="17">
                <label class="form-check-label" for="genre17">Reality</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre18" name="genreIds" value="18">
                <label class="form-check-label" for="genre18">Romance</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre19" name="genreIds" value="19">
                <label class="form-check-label" for="genre19">Science Fiction</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre20" name="genreIds" value="20">
                <label class="form-check-label" for="genre20">Soap</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre21" name="genreIds" value="21">
                <label class="form-check-label" for="genre21">Talk</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre22" name="genreIds" value="22">
                <label class="form-check-label" for="genre22">TV Movie</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre23" name="genreIds" value="23">
                <label class="form-check-label" for="genre23">Thriller</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre24" name="genreIds" value="24">
                <label class="form-check-label" for="genre24">War</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="genre25" name="genreIds" value="25">
                <label class="form-check-label" for="genre25">Western</label>
              </li>
              <li><button class="btn btn-primary" onclick="applyGenreSelection()">Apply</button></li>
            </ul>
          </div>

          &nbsp;
          &nbsp;

          <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="languageDropdown"
              data-bs-toggle="dropdown" aria-expanded="false">
              Select Languages
            </button>
            <ul class="dropdown-menu" aria-labelledby="languageDropdown" id="languageCheckboxes">
              <li><input class="form-check-input" type="checkbox" id="cn" name="languages" value="cn">
                <label class="form-check-label" for="cn">Chinese(Cantonese)</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="zh" name="languages" value="zh">
                <label class="form-check-label" for="zh">Chinese(Mandarin)</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="da" name="languages" value="da">
                <label class="form-check-label" for="da">Danish</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="en" name="languages" value="en">
                <label class="form-check-label" for="en">English</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="fr" name="languages" value="fr">
                <label class="form-check-label" for="fr">French</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="de" name="languages" value="de">
                <label class="form-check-label" for="de">German</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="hi" name="languages" value="hi">
                <label class="form-check-label" for="hi">Hindi</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="it" name="languages" value="it">
                <label class="form-check-label" for="it">Italian</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="ja" name="languages" value="ja">
                <label class="form-check-label" for="ja">Japanese</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="kn" name="languages" value="kn">
                <label class="form-check-label" for="kn">Kannada</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="ko" name="languages" value="ko">
                <label class="form-check-label" for="ko">Korean</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="mr" name="languages" value="mr">
                <label class="form-check-label" for="mr">Marathi</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="ru" name="languages" value="ru">
                <label class="form-check-label" for="ru">Russian</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="es" name="languages" value="es">
                <label class="form-check-label" for="es">Spanish</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="ta" name="languages" value="ta">
                <label class="form-check-label" for="ta">Tamil</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="te" name="languages" value="te">
                <label class="form-check-label" for="te">Telugu</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="th" name="languages" value="th">
                <label class="form-check-label" for="th">Thai</label>
              </li>
              <li><button class="btn btn-primary" onclick="applyLanguageSelection()">Apply</button></li>
            </ul>
          </div>

          &nbsp;
          &nbsp;

          <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="statusDropdown"
              data-bs-toggle="dropdown" aria-expanded="false">
              Select Statuses
            </button>
            <ul class="dropdown-menu" aria-labelledby="statusDropdown" id="statusCheckboxes">
              <li><input class="form-check-input" type="checkbox" id="cn" name="statuses" value="Rumored">
                <label class="form-check-label" for="Rumored">Rumored</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="zh" name="statuses" value="Planned">
                <label class="form-check-label" for="Planned">Planned</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="zh" name="statuses" value="Pilot">
                <label class="form-check-label" for="Pilot">Pilot</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="zh" name="statuses" value="In Production">
                <label class="form-check-label" for="In Production">In Production</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="zh" name="statuses" value="Post Production">
                <label class="form-check-label" for="Post Production">Post Production</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="zh" name="statuses" value="Cancelled">
                <label class="form-check-label" for="Cancelled">Cancelled</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="zh" name="statuses" value="Returning Series">
                <label class="form-check-label" for="Returning Series">Airing</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="zh" name="statuses" value="Released">
                <label class="form-check-label" for="Released">Released</label>
              </li>
              <li><input class="form-check-input" type="checkbox" id="zh" name="statuses" value="Ended">
                <label class="form-check-label" for="Ended">Ended</label>
              </li>
              <li><button class="btn btn-primary" onclick="applyStatusSelection()">Apply</button></li>
            </ul>
          </div>

          &nbsp;
          &nbsp;

          From :
          <!-- <select name="startYear"> -->
          <select th:field="*{startYear}">
            <option value="">Year</option>
            <option th:value="${year}" th:text="${year}" th:each="year : ${#numbers.sequence(2023, 1950, -1)}"></option>
          </select>

          &nbsp;
          &nbsp;

          To :
          <!-- <select name="endYear"> -->
          <select th:field="*{endYear}">
            <option value="">Year</option>
            <option th:value="${year}" th:text="${year}" th:each="year : ${#numbers.sequence(2023, 1950, -1)}"></option>
          </select>

          &nbsp;
          &nbsp;

          <i class="bi bi-eye-fill"></i>
          <!-- <select name="watched"> -->
          <select th:field="*{watched}">
            <option value="">All</option>
            <option value="true">Watched</option>
            <option value="false">Un-watched</option>
          </select>

          &nbsp;
          &nbsp;

          <button class="btn btn-light" type="submit">Submit</button>
        </form>

      </div>
      <div class="col-3 justify-content-end">
        <form th:action=" @{/track-servie/servies/search}">
          <input type="text" id="query" name="query">
          <input type="text" id="year" name="year">
          &nbsp;
          &nbsp;
          <i class="bi bi-arrow-down-up"></i>
          <select th:name="type">
            <option value="movie">Movie</option>
            <option value="tv">Series</option>
          </select>
          <button class="btn btn-light" type="submit">
            <i class="bi bi-search"></i>
          </button>
        </form>
      </div>

      <form th:action="@{/logout}" method="post">
        <input type="submit" value="Logout">
      </form>

    </div>
    <div class="row center">
      <div class="col-xxl-1 col-sm-2 col-3 image-container poster" th:each="servie : ${response.servies}"
        th:id="${servie.childtype + servie.tmdbId}">
        <!-- <div th:if="${servie instanceof T(servie.track_servie.entities.Movie)}"> -->
        <div th:if="${servie.childtype == 'movie'}">
          <img class="rounded image-border" th:src="'https://www.themoviedb.org/t/p/original'+${servie.posterPath}"
            alt="Poster Unavailable" />
          <div class="buttons-container rounded">
            <a th:href="@{'/track-servie/servies/'+${servie.tmdbId}+'?type=movie'}">
              <strong th:text="${servie.title}"></strong>
            </a>
            <br>
            <span th:if="${servie.releaseDate != null}" th:text="${#temporals.year(servie.releaseDate)}"></span>
            <!-- hyperlink -->
            <a th:href="@{'/track-servie/servies/'+${servie.tmdbId}+'/toggleback?type='+${servie.childtype}}">
              <div th:if="${servie.completed}">
                <i class="bi bi-eye-slash-fill"></i>
              </div>
              <div th:unless="${servie.completed}">
                <i class="bi bi-eye-fill"></i>
              </div>
            </a>
            <!-- javascript+ajax+jquery -->
            <!-- able to toggle value in backend, but not able to change the class of icon -->
            <a href="#" th:if="${servie.completed}" th:tmdbId="${servie.tmdbId}" th:childtype="${servie.childtype}"
              onclick="toggleWatch(this.getAttribute('tmdbId'), this.getAttribute('childtype'), false)">
              <i class="bi bi-eye-slash-fill"></i>
            </a>
            <a href="#" th:if="${not servie.completed}" th:tmdbId="${servie.tmdbId}" th:childtype="${servie.childtype}"
              onclick="toggleWatch(this.getAttribute('tmdbId'), this.getAttribute('childtype'), true)">
              <i class="bi bi-eye-fill"></i>
            </a>
            <a th:href="@{'/track-servie/servies/'+${servie.tmdbId}+'/posters?type='+${servie.childtype}}">
              <i class="bi bi-file-image"></i>
            </a>
            <a th:href="@{'/track-servie/list/'+${servie.tmdbId}+'?childtype='+${servie.childtype}}">
              <i class="bi bi-clock-fill"></i>
            </a>
            <a href="#" th:tmdbId="${servie.tmdbId}" th:childtype="${servie.childtype}"
              onclick="removeServie(this.getAttribute('tmdbId'), this.getAttribute('childtype'))">
              <i class="bi bi-x-circle-fill"></i>
            </a>

          </div>


        </div>
        <!-- <div th:if="${servie instanceof T(servie.track_servie.entities.Series)}" -->
        <div th:if="${servie.childtype == 'tv'}">
          <img class="rounded image-border" th:src="'https://www.themoviedb.org/t/p/original'+${servie.posterPath}" />
          <div class="buttons-container rounded">
            <a th:href="@{'/track-servie/servies/'+${servie.tmdbId}+'?type=tv'}">
              <strong th:text="${servie.title}"></strong>
            </a>
            <br>
            <span
              th:text="${#temporals.year(servie.firstAirDate)} + ' - ' + (${#temporals.year(servie.lastAirDate)} == '2023' ? 'present' : ${#temporals.format(servie.lastAirDate,'yy')})">
            </span>
            <br />
            <span th:text="${servie.episodesWatched}+'/'+${servie.totalEpisodes}"></span>
            <a th:href="@{'/track-servie/servies/'+${servie.tmdbId}+'/toggleback?type='+${servie.childtype}}">
              <div th:if="${servie.completed}">
                <i class="bi bi-eye-slash-fill"></i>
              </div>
              <div th:unless="${servie.completed}">
                <i class="bi bi-eye-fill"></i>
              </div>
            </a>
            <a th:href="@{'/track-servie/servies/'+${servie.tmdbId}+'/posters?type='+${servie.childtype}}">
              <i class="bi bi-file-image"></i>
            </a>

            <a th:href="@{'/track-servie/list/'+${servie.tmdbId}+'?childtype='+${servie.childtype}}">
              <i class="bi bi-clock-fill"></i>
            </a>

            <a href="#" th:tmdbId="${servie.tmdbId}" th:childtype="${servie.childtype}"
              onclick="removeServie(this.getAttribute('tmdbId'), this.getAttribute('childtype'))">
              <i class="bi bi-x-circle-fill"></i>
            </a>

            <div class="progress-bar">
              <div class="progress" th:with="progress=((${servie.episodesWatched}/${servie.totalEpisodes})*100)"
                th:text="${#numbers.formatDecimal(progress, 1, 'DEFAULT', 0, 'DEFAULT')}+' %'"
                th:style="'width:' + ${progress} + '%;'"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <span th:text="'There are ' + ${response.totalElements} + ' servies matching your filters'"></span>

  <nav id="paginationNav" th:if="${response.totalPages > 1}">
    <ul class="pagination justify-content-center">
      <!-- Previous button (enable - if there is previous pg available) -->
      <li class="page-item" th:classappend="${response.hasPrevious} ? '' : 'disabled'">
        <a class="page-link" href="javascript:void(0);"
          th:onclick="'submitPaginationForm(' + (${response.pageNumber - 1}) + ');'">Previous</a>
      </li>

      <!-- First Page -->
      <li class="page-item">
        <a class="page-link" th:if="${response.pageNumber != 0}" href="javascript:void(0);"
          th:onclick="'submitPaginationForm(0);'">1</a>
      </li>

      <!-- Gap if ............ -->
      <li class="page-item" th:if="${response.pageNumber > 3}">
        <a class="page-link disabled" href="#"><span>...</span></a>
      </li>

      <li class="page-item">
        <a class="page-link" th:if="${response.pageNumber > 2}" href="javascript:void(0);"
          th:onclick="'submitPaginationForm(' + (${response.pageNumber - 2}) + ');'">[[${response.pageNumber-1}]]</a>
      </li>

      <li class="page-item">
        <a class="page-link" th:if="${response.pageNumber > 1}" href="javascript:void(0);"
          th:onclick="'submitPaginationForm(' + (${response.pageNumber - 1}) + ');'">[[${response.pageNumber}]]</a>
      </li>

      <li class="active">
        <a class="page-link" href="javascript:void(0);"
          th:onclick="'submitPaginationForm(' + ${response.pageNumber} + ');'">[[${response.pageNumber+1}]]</a>
      </li>

      <li class="page-item">
        <a class="page-link" th:if="${response.pageNumber < response.totalPages - 2}" href="javascript:void(0);"
          th:onclick="'submitPaginationForm(' + (${response.pageNumber + 1}) + ');'">[[${response.pageNumber+2}]]</a>
      </li>

      <li class="page-item">
        <a class="page-link" th:if="${response.pageNumber < response.totalPages - 3}" href="javascript:void(0);"
          th:onclick="'submitPaginationForm(' + (${response.pageNumber + 2}) + ');'">[[${response.pageNumber+3}]]</a>
      </li>

      <!-- Gap if currentPg is < totalPages-4 -->
      <li class="page-item" th:if="${response.pageNumber < response.totalPages - 4}">
        <a class="page-link disabled" href="#"><span>...</span></a>
      </li>

      <!-- Last Page -->
      <li class="page-item">
        <a class="page-link" th:if="${response.pageNumber != response.totalPages - 1}" href="javascript:void(0);"
          th:onclick="'submitPaginationForm(' + (${response.totalPages - 1}) + ');'"
          th:text="${response.totalPages}"></a>
      </li>

      <!-- Next button (enable - if there is next pg available) -->
      <li class="page-item" th:classappend="${response.hasNext} ? '' : 'disabled'">
        <a class="page-link" href="javascript:void(0);"
          th:onclick="'submitPaginationForm(' + (${response.pageNumber + 1}) + ');'">Next</a>
      </li>
    </ul>
  </nav>

  <script>

    function submitPaginationForm(pageNumber) {

      console.log('pageNumber:', pageNumber);

      // Create the ServiceForm object
      const serviceForm = {
        sortDir: "asc",
        genreIds: JSON.parse(sessionStorage.getItem('genres')) || [],
        languages: JSON.parse(sessionStorage.getItem('languages')) || [],
        statuses: JSON.parse(sessionStorage.getItem('statuses')) || [],
        watched: null, // Set as needed
        type: "",
        startYear: null, // Set as needed
        endYear: null, // Set as needed
        pageNumber: pageNumber,
        sortBy: "title"
      };

      // Print the ServiceForm object to the console for debugging
      console.log('ServiceForm:', serviceForm);

      // Send the ServiceForm object via a POST request using fetch
      fetch('/track-servie/servies/js', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(serviceForm)
      })
        .then(response => response.json())
        .then(data => {
          console.log('Success:', data);
          // Check if the elements exist before updating them
          const contentElement = document.getElementById('content');
          const paginationNavElement = document.getElementById('paginationNav');

          if (contentElement) {
            contentElement.innerHTML = data.contentHtml;
          } else {
            console.error('Element with ID "content" not found.');
          }

          if (paginationNavElement) {
            paginationNavElement.innerHTML = data.paginationHtml;
          } else {
            console.error('Element with ID "paginationNav" not found.');
          }
        })
        .catch((error) => {
          console.error('Error:', error);
        });
    }

    function updatePageContent(data) {
      // Assuming 'data' contains the HTML to update the content
      // This part should be adjusted based on the actual structure of your response

      // Example: Updating the content of a div with id 'content'
      document.getElementById('content').innerHTML = data.htmlContent;

      // Update other parts of the page as needed
      // Example: Update the pagination controls
      document.getElementById('paginationNav').innerHTML = data.paginationHtml;
    }

    // Storing data into sessionStorage for 'languages'
    function applyLanguageSelection() {
      const checkboxes = document.querySelectorAll('#languageCheckboxes input[type="checkbox"]:checked');
      const selectedLanguages = Array.from(checkboxes).map(checkbox => checkbox.value);
      sessionStorage.setItem('languages', JSON.stringify(selectedLanguages));
    }

    // Storing data into sessionStorage for 'genres'
    function applyGenreSelection() {
      const checkboxes = document.querySelectorAll('#genreCheckboxes input[type="checkbox"]:checked');
      const selectedGenres = Array.from(checkboxes).map(checkbox => checkbox.value);
      sessionStorage.setItem('genres', JSON.stringify(selectedGenres));
    }

    // Storing data into sessionStorage for 'statuses'
    function applyStatusSelection() {
      const checkboxes = document.querySelectorAll('#statusCheckboxes input[type="checkbox"]:checked');
      const selectedStatuses = Array.from(checkboxes).map(checkbox => checkbox.value);
      sessionStorage.setItem('statuses', JSON.stringify(selectedStatuses));
    }

    // Check all the language check-boxes automatically on page refresh from the sessionStorage
    document.addEventListener('DOMContentLoaded', function () {
      const formCheckboxes = document.querySelectorAll('#languageCheckboxes input[type="checkbox"]');
      const savedLanguages = sessionStorage.getItem('languages');
      if (savedLanguages !== null) {
        const selectedLanguages = JSON.parse(savedLanguages);
        formCheckboxes.forEach(function (checkbox) {
          if (selectedLanguages.includes(checkbox.value)) {
            checkbox.checked = true;
          }
        });
      }
    });

    // Check all the genre check-boxes automatically on page refresh from the sessionStorage
    document.addEventListener('DOMContentLoaded', function () {
      const formCheckboxes = document.querySelectorAll('#genreCheckboxes input[type="checkbox"]');
      const savedGenres = sessionStorage.getItem('genres');
      if (savedGenres !== null) {
        const selectedGenres = JSON.parse(savedGenres);
        formCheckboxes.forEach(function (checkbox) {
          if (selectedGenres.includes(checkbox.value)) {
            checkbox.checked = true;
          }
        });
      }
    });

    // Check all the status check-boxes automatically on page refresh from the sessionStorage
    document.addEventListener('DOMContentLoaded', function () {
      const formCheckboxes = document.querySelectorAll('#statusCheckboxes input[type="checkbox"]');
      const savedStatuses = sessionStorage.getItem('statuses');
      if (savedStatuses !== null) {
        const selectedStatuses = JSON.parse(savedStatuses);
        formCheckboxes.forEach(function (checkbox) {
          if (selectedStatuses.includes(checkbox.value)) {
            checkbox.checked = true;
          }
        });
      }
    });
  </script>
</body>

</html>